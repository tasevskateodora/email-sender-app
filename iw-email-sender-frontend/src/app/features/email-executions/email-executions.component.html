<div class="container">
  <h2>Email Execution Stats</h2>

  <mat-form-field>
    <mat-label>Status Filter</mat-label>
    <mat-select [(value)]="selectedStatus" (selectionChange)="applyFilter()">
      <mat-option value="ALL">All</mat-option>
      <mat-option value="SUCCESS">Success</mat-option>
      <mat-option value="FAIL">Fail</mat-option>
    </mat-select>
  </mat-form-field>

  <table mat-table [dataSource]="filteredExecutions" class="mat-elevation-z8">

    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef> ID </th>
      <td mat-cell *matCellDef="let row"> {{row.id}} </td>
    </ng-container>

    <ng-container matColumnDef="executedAt">
      <th mat-header-cell *matHeaderCellDef> Executed At </th>
      <td mat-cell *matCellDef="let row"> {{row.executedAt | date:'short'}} </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef> Status </th>
      <td mat-cell *matCellDef="let row">
        <span [ngClass]="row.status === 'SUCCESS' ? 'status-success' : 'status-fail'">
          {{row.status}}
        </span>
      </td>
    </ng-container>

    <ng-container matColumnDef="errorMessage">
      <th mat-header-cell *matHeaderCellDef> Error </th>
      <td mat-cell *matCellDef="let row"> {{row.errorMessage || '-'}} </td>
    </ng-container>

    <ng-container matColumnDef="retryAttempt">
      <th mat-header-cell *matHeaderCellDef> Retries </th>
      <td mat-cell *matCellDef="let row"> {{row.retryAttempt}} </td>
    </ng-container>

    <ng-container matColumnDef="jobSenderEmail">
      <th mat-header-cell *matHeaderCellDef> Sender </th>
      <td mat-cell *matCellDef="let row"> {{row.jobSenderEmail}} </td>
    </ng-container>

    <ng-container matColumnDef="jobReceiverEmails">
      <th mat-header-cell *matHeaderCellDef> Receivers </th>
      <td mat-cell *matCellDef="let row"> {{row.jobReceiverEmails}} </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
